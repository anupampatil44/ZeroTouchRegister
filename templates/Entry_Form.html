<!DOCTYPE html>
<html lang="en">
<head>
	<title>Entry Form</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	{% load static %}
<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="{% static 'images/icons/favicon.ico' %}"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'fonts/font-awesome-4.7.0/css/font-awesome.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'fonts/iconic/css/material-design-iconic-font.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/animate/animate.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/css-hamburgers/hamburgers.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/animsition/css/animsition.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/select2/select2.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/daterangepicker/daterangepicker.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'vendor/noui/nouislider.min.css' %}">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="{% static 'css/util.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
<!--===============================================================================================-->
</head>
<body onload=display_ct()>

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li>{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

	<div class="container-contact100">
		<div class="wrap-contact100">

	    <p class="label-input100">Date/Time: <span id="ct"></span></p>

			<form class="contact100-form validate-form" method="post" name="entry">
				{% csrf_token %}
    			{{ form }}
				<input type="hidden" id="csrf_token" value='{"csrfmiddlewaretoken": "{{ csrf_token }}"}'>
				<span onclick="window.location.href='{% url "home" %}'" class="contact100-form-title">
					Entry
				</span>

				<div class="wrap-input100 validate-input bg1" data-validate="Please Type Your Name">
					<span class="label-input100">FULL NAME<font color="red">	*</font></span>
					<input class="input100" type="text" id="name" name="name" placeholder="Enter Your Name" required>

				</div>

				<div class="wrap-input100 bg1 rs1-wrap-input100" data-validate = "Enter Your Email (e@a.x)">
					<span class="label-input100">Email </span>
					<input class="input100" type="text" name="email" placeholder="Enter Your Email ">
				</div>



				<div class="wrap-input100 bg1 rs1-wrap-input100">
					<span class="label-input100">Phone<font color="red">	*</font></span>
					<input class="input100" type="number" name="phone" placeholder="Enter Number Phone" required>
				</div>

				<div class="wrap-input100 bg1 rs1-wrap-input100" >
					<span class="label-input100">Address(City) </span>
					<input class="input100" type="text" name="address" placeholder="Enter Your City ">
				</div>

				<div class="wrap-input100 bg1 rs1-wrap-input100" >
					<span class="label-input100">Purpose </span>
					<input class="input100" type="text" name="purpose" placeholder="Enter Your Purpose ">
				</div>

				<div class="wrap-input100 input100-select bg1">
					<span class="label-input100">Section to be visited</span>
					<div>
						<select class="js-select2" name="department">
							<option>  </option>
							<option>Admission</option>
							<option>Student Section</option>
							<option>Library</option>
							<option>Hostel</option>
							<option>First Year Department</option>
							<option>Computer Department</option>
							<option>IT Department</option>
							<option>E&TC Department</option>
						</select>
						<div class="dropDownSelect2"></div>
					</div>
				</div>

				<div class="wrap-input100 input100-select bg1 rs1-wrap-input100">
					<span class="label-input100">Identity</span>
					<div>
						<select id="identity" class="js-select2" name="identity">
							<option>  </option>
							<option>Student</option>
							<option>Parent</option>
							<option>Gaurdian</option>
							<option>Others</option>
						</select>
						</select>
						<div class="dropDownSelect2"></div>
					</div>
				</div>

				<div class="wrap-input100 bg1 rs1-wrap-input100" >
					<span class="label-input100" >If Others then specify </span>
					<input  class="input100" type="text" id="otherIdentity" name="otherIdentity" placeholder="Enter Your Identity " disabled>
				</div>

                <div class="wrap-input100 validate-input bg1 rs1-wrap-input100" >
					<span class="label-input100">Referred by </span>
					<input class="input100" type="text" name="refname" placeholder="Enter Refered by " required>
				</div>

				<div class="wrap-input100 validate-input bg1 rs1-wrap-input100" >
					<span class="label-input100">Contact No. of Referer </span>
					<input class="input100" type="text" name="refcontact" placeholder="Enter Contact No. of referer  " required>
				</div>

				<div class="wrap-input100 bg1 rs1-wrap-input100" >
					<span class="label-input100">Reference (ID) number<font color="red">	*</font> </span>
					<input class="input100" type="number" id="ref" name="Reference_student" placeholder="Enter Reference Number " required>
				</div>

				<div class="wrap-input100 bg1 rs1-wrap-input100" >
					<span class="label-input100">Aadhar number </span>
					<input class="input100" type="number" name="aadhar" placeholder="Enter Aadhar Number ">
				</div>




				<div class="wrap-input100 bg1 rs1-wrap-input100 my_camera" id="my_camera">

				</div>

				<div class="wrap-input100 bg1 rs1-wrap-input100 results" id="results">

				</div>
				<input name="imagename" type="text" id="imagename">
				<div class="container-contact100-form-btn">
					<button id="snap" type="button" class="contact100-form-btn">
						<span>
							Take Snapshot
						</span>
					</button>
				</div>

				<div class="container-contact100-form-btn">
					<button type="submit" class="contact100-form-btn">
						<span>
							Submit
							<i class="fa fa-long-arrow-right m-l-7" aria-hidden="true"></i>
						</span>
					</button>
				</div>
			</form>
		</div>
	</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-alpha1/html2canvas.js">
</script>
	<script>
		var ref=document.getElementById("ref").value;

	</script>

<!--===============================================================================================-->
	<script src="{% static 'vendor/jquery/jquery-3.2.1.min.js' %}"></script>
<!--===============================================================================================-->
	<script src="{% static 'vendor/animsition/js/animsition.min.js' %}"></script>
<!--===============================================================================================-->
	<script src="{% static 'vendor/bootstrap/js/popper.js' %}"></script>
	<script src="{% static 'vendor/bootstrap/js/bootstrap.min.js' %}"></script>
<!--===============================================================================================-->
	<script src="{% static 'vendor/select2/select2.min.js' %}"></script>
	<script type="text/javascript">
		document.getElementById("otherIdentity").defaultValue = "NA";
		$(function () {
        $("#identity").change(function () {
            if ($(this).val() == "Others") {
                $("#otherIdentity").removeAttr("disabled");
                $("#otherIdentity").focus();
            } else {
                $("#otherIdentity").attr("disabled", "disabled");
            }
        });
    });
		function display_c(){
		var refresh=1000; // Refresh rate in milli seconds
		mytime=setTimeout('display_ct()',refresh)
		}

		function display_ct() {
		var x = new Date()
		document.getElementById('ct').innerHTML = x;
		display_c();
		 }
	</script>
	<script>
		$(".js-select2").each(function(){
			$(this).select2({
				minimumResultsForSearch: 20,
				dropdownParent: $(this).next('.dropDownSelect2')
			});


			$(".js-select2").each(function(){
				$(this).on('select2:close', function (e){
					if($(this).val() == "Please chooses") {
						$('.js-show-service').slideUp();
					}
					else {
						$('.js-show-service').slideUp();
						$('.js-show-service').slideDown();
					}
				});
			});
		})
	</script>
<!--===============================================================================================-->
	<script src="{% static 'vendor/daterangepicker/moment.min.js' %}"></script>
	<script src="{% static 'vendor/daterangepicker/daterangepicker.js' %}"></script>
<!--===============================================================================================-->
	<script src="{% static 'vendor/countdowntime/countdowntime.js' %}"></script>
<!--===============================================================================================-->

<!--===============================================================================================-->
	<script src="{% static 'js/main.js' %}"></script>

<!--===============================================================================================-->
<script src="{% static 'js/webcamjs-master/webcam.min.js' %}"></script>
<script src="{% static 'js/webcamjs-master/webcam.js' %}"></script>
<!--===============================================================================================-->
<!--===============================================================================================-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
<!-- Configure a few settings and attach camera -->
<script language="JavaScript">
	Webcam.set({
	 width: 320,
	 height: 240,
	 image_format: 'jpeg',
	 jpeg_quality: 75
	});
	Webcam.attach( '#my_camera' );

   // Code to handle taking the snapshot and displaying it locally


	// take snapshot and get image data
	$("button").click(function() {
		Webcam.snap(function (data_uri) {
			// display results in page
			document.getElementById('results').innerHTML =
					'<img src="' + data_uri + '"/>';
		});
	});
	var name="";
	$(function () {
        $("#name").change(function () {
             name=$(this).val();

        });
    });

	$(function() {
    $("#snap").click(function() {
        html2canvas($("#results"), {
            onrendered: function(canvas) {
                theCanvas = canvas;

                canvas.toBlob(function(blob) {
                	var currentTime = new Date();
                	var currentOffset = currentTime.getTimezoneOffset();
					var ISTOffset = 330;   // IST offset UTC +5:30
                	currentTime = new Date(currentTime.getTime() + (ISTOffset + currentOffset)*60000);
                	var day = String(currentTime.getDate()).padStart(2, '0');
					var month = String(currentTime.getMonth() + 1).padStart(2, '0'); //January is 0!
					var year = currentTime.getFullYear();
                	var hour=currentTime.getHours();
                	var minutes=currentTime.getMinutes();
                	var seconds=currentTime.getSeconds();
                	var filename=year+"/"+month+"/"+day+"/"+hour+":"+minutes+":"+seconds+"_"+name+".png";
                	document.getElementById("imagename").value = filename;
                    saveAs(blob, filename);
                });
            }
        });
    });

});

   </script>
